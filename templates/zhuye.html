{% extends 'base.html' %}
{% block title %}主页{% endblock %}
​{% block body %} 
<script type="text/javascript">
	$(document).ready(function(){
		$(".pohai").click(function(){
			var id=this.id
			$.post("/persecute?uid="+id,function(data,status){
				if (status=="success")
					$("#"+id).html("迫害成功，共"+data+"次");
				else
					$("#"+id).html("迫害失败:"+status);
				setTimeout('$("#'+id+'").html("迫害")',1500);
			})
		})
	})
	var d=[];
	var x=[];
</script>
			<p style="text-align: center;">
				 <strong>今日共{{v}}条消息，以下是龙王榜</strong>
			</p>
			<p style="text-align: center;">
				 点击条数后面的迫害迫害用户！
			</p>
			<table class="ui celled table" style="text-align: center;">
				<thead>
					<tr>
						<th>
							排名
						</th>
						<th>
							uid
						</th>
						<th>
							username
						</th>
						<th>
							犇犇条数
						</th>
						<th>
							迫害
						</th>
					</tr>
				</thead>
				<tbody>
				{% for i in b %}
					<script type="text/javascript">
			            d.push( "{{i.username}}");
			            x.push( "{{i.count}}");
			        </script>
					<tr>
						<td>
							{% if loop.index==1 %}
								<svg t="1588329338352" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1118" width="20" height="20"><path d="M824.891164 113.777778V28.444444a28.444444 28.444444 0 0 0-28.444444-28.444444H227.557831a28.444444 28.444444 0 0 0-28.444444 28.444444v85.333334H0.002276v227.555555a256 256 0 0 0 232.96 256A312.888889 312.888889 0 0 0 455.113387 762.595556V910.222222l-113.777778 113.777778h341.333333l-113.777778-113.777778v-147.626666A312.888889 312.888889 0 0 0 791.042276 597.333333 256 256 0 0 0 1024.002276 341.333333V113.777778zM113.780053 341.333333V227.555556h85.333334v244.337777A142.222222 142.222222 0 0 1 113.780053 341.333333z m796.444445 0a142.222222 142.222222 0 0 1-85.333334 130.56V227.555556h85.333334z" p-id="1119" fill="#FFD700"></path></svg>
							{% endif %}
							{% if 2<=loop.index<=5 %}
								<svg t="1588329338352" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1118" width="20" height="20"><path d="M824.891164 113.777778V28.444444a28.444444 28.444444 0 0 0-28.444444-28.444444H227.557831a28.444444 28.444444 0 0 0-28.444444 28.444444v85.333334H0.002276v227.555555a256 256 0 0 0 232.96 256A312.888889 312.888889 0 0 0 455.113387 762.595556V910.222222l-113.777778 113.777778h341.333333l-113.777778-113.777778v-147.626666A312.888889 312.888889 0 0 0 791.042276 597.333333 256 256 0 0 0 1024.002276 341.333333V113.777778zM113.780053 341.333333V227.555556h85.333334v244.337777A142.222222 142.222222 0 0 1 113.780053 341.333333z m796.444445 0a142.222222 142.222222 0 0 1-85.333334 130.56V227.555556h85.333334z" p-id="1119" fill="#C0C0C0"></path></svg>
							{% endif %}
							{% if loop.index>=6 %}
								<svg t="1588329338352" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1118" width="20" height="20"><path d="M824.891164 113.777778V28.444444a28.444444 28.444444 0 0 0-28.444444-28.444444H227.557831a28.444444 28.444444 0 0 0-28.444444 28.444444v85.333334H0.002276v227.555555a256 256 0 0 0 232.96 256A312.888889 312.888889 0 0 0 455.113387 762.595556V910.222222l-113.777778 113.777778h341.333333l-113.777778-113.777778v-147.626666A312.888889 312.888889 0 0 0 791.042276 597.333333 256 256 0 0 0 1024.002276 341.333333V113.777778zM113.780053 341.333333V227.555556h85.333334v244.337777A142.222222 142.222222 0 0 1 113.780053 341.333333z m796.444445 0a142.222222 142.222222 0 0 1-85.333334 130.56V227.555556h85.333334z" p-id="1119" fill="#B87333"></path></svg>
							{% endif %}
							#{{loop.index}}
						</td>
						<td>
							{{i.uid}}
						</td>
						<td>
							{% if loop.index==1 %}
							<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFiUAABYlAUlSJPAAAAAGYktHRAD/AP8A/6C9p5MAAAVQSURBVEhL7ZV5bFRVFIe/2afz6NAyA1i2ooWWAgUiSFhUChQsQQWEEIksAQJq1IQAQVkkCkaIAQNYSVgsGhPrAiKyii0US8pOW2hl3+l0us4MM9POTGfm+frmCRQaMErwH77k5N577vJ7575z71WJEvwPqJXysfNE+LHxyIQP7vpOqd2hKP83/L46pdWYRyZcdbWY4qP7lFYEd42d/B2blFZj/pGwraKKLdm5SusOhQd3c+NSiVzXBT04bp7DUVXGkZyfZV/Q48BXfkmu38tDhWt9PuasXEN8XGvmrPhC9pVVVctlj4HpZMwaidPtgYozhNU6Yq1xbF09F4fTSU1JDhqDII+9l4cK5xw5zvzpk+nTLRnHrVuyb/KCJXKpVqlo17otPy54lSi9gZTU12R/ynOpfD1vJPEtTLTuMUT23UuTwl9+v4UZHy8j72Qhm37ZSY/ETrI/c8lC3l+1lo3LI8INnNfr6NSqJQ5rT6JrAzhy9mMrK6Vrx3hK3AZ69k1VRjbmviuzosZB5tYdfDB9EtmHj9M1oSNtWlqV3gjnv8rgcE01s22nGFF4kx1zx6HRq7AeP8ubufloEhNwu2zMXJRFy8REruVkEz80TZkd4b6Ihago6oNBuZ7Wr899otlj+xOTt4L0wiyOHz3PCzYXhtYtaSGYcQ7rR2mvblDnpv/RztgP5Mhz1qcNk8u7aULYSLXLxaGCU+QeO6F4I/hOFRBXUUBlv1kUpc3iMymKxUunYrI7CHv9aHxBtG43uQmJtKkTuV58gs0dezFA6EUg6FNWidDkP7ZENWPA+OkMfncelvRRvDxvPqrBqSRv2MAUe3tWHf2Tp6fOIKtdc3R1QURvgLAkatp3mLzkRLYPSCKgqSDm91I6W/uAMYzf6VJWj9Dks9jh+dGUh4IYBQNhg4agRsQU0wy/DgYkJ5HarSvL87MRok3oBD1qkx6NOYpAfT3qWAFnyE3R/FNU6vXyemUX8xhReQ6dNtJuoMmIp6QPJXDhGm6nhzqnl3qPH1elE7/DS37xWT7dto0ov4iqtp6wZAFpjO2PQmovlSFKdb3Th94soNGZ0OoD1KrrGok20CjifgsXUWoOkzltBuoiG+s2b0ejUiO0EGhliSVKMJKxcxcBixmdFKXapJMNaVdURi3aaCM1FdW0l6Lfm+XEFnagC9/g1tBBDFq2XFGJcFv4naWrWbtrN8THMvuNMax8Zbw8YL2jhJmxUqYqlNnLaTNhMpaObVFH6VBJ1iDuR4rslotmKYn0Ly5lVYEdr8rOJcHCGOlj671e6bfcucVub7VBq5UOsYe02HiGt0pgYuY6VB9OoXsoWhkB9vJKUsZNRTCZpSyWEkqxkGSBej+mVnFUV3t5r+I6N50l3OzSm4TRY/hEuuHuFm2g0VZ3GPI6N06fBa2I+cUeXPlmHS2MJrlv7kefszIjE2OXZ1Ab9AR1GmiIWEqukF5KQEIka0KscV3FfaCAUIwZizHElTN2Jrn96KQ5d3NfVrtcbrRaDYJgYuJbC/D4A2zbs1/aEiNEN5cOs5+2FhV9OkdjNWvR1XjoEmNgaDMjbdzSS1Z+mRiLlusF5yiL7srY3Dxl5cY0eZz+5qdf9zJ+1FRISgJPLUuNF5nc20rzhDiaD+7GjR+OEXZJmS9dOJ5aH153nfThAdTdh9Bz8TLa931WWakJGoQfRP6RArFn2gTRmjJcFCts4sm5b4u5KYJYNOIp8cq0JHF7F6t4ZfcesfrcBdFdXqXMejgPjPhBnM/ciOf0IUKOUi4fOMnA9d/SbthLSu/D+dfC/5Umb67HwRPhxwT8BTxqbcs/sI78AAAAAElFTkSuQmCC">
							{% endif %}
							<a href="/user/{{i.uid}}">{{i.username}}</a>
						</td>
						<td>
							{{i.count}}
						</td>
						<td class="pohai" id="{{i.uid}}">
							迫害
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			<p style="text-align: center;">如果看不全人名请鼠标悬浮在条上</p>
			<div id="main" style="width: 100%;height:600px;text-align:center;"></div>
			<script type="text/javascript">
		        var myChart = echarts.init(document.getElementById('main'));
		        var option = {
		            title: {
		                text: '可视化排行榜'
		            },
		            tooltip: {},
		            legend: {
		                data:['犇犇条数']
		            },
		            xAxis: {},
		            yAxis: 
		            {
		            	data:d.reverse()
		            },
		            series: [{
		                name: '犇犇条数',
		                type: 'bar',
		                data:x.reverse()
		            }]
		        };
		        myChart.setOption(option);
    		</script>
			<form method="POST">
	            {{ form.csrf_token }}
	            <div class="ui labeled input" style="text-align: center;">
					<div class="ui label">
						用户名:
					</div>
					<input id="username" name="username" required="" type="text" value="">
				</div>
	            <input class = "ui primary button" id="submit" name="submit" type="submit" value="查询">
	        </form>
	        <p style="text-align: center;">
				 输入UID可以同步最新的20条犇犇！
			</p>
	        <div class="ui labeled input" style="text-align: center;">
				<div class="ui label">
					uid:
				</div>
				<input type="text" placeholder="UID" id="uid">
			</div>
	        <button class="ui primary button" id="check">
				更新
			</button>
			<script type="text/javascript">
	        	$("#check").on('click',function(){
	        		$(this).attr("class", "ui primary loading button");
	        		$.get('/api/checkbenben?uid='+$('#uid').val(),function(data,status){
	        			if (status="success")
	        			{
	        				$('#check').attr("class", "ui primary button")
	        				if (data!=0)
	        				{
	        					$('#check').text("成功同步了今天的"+data+"条新消息")
	        				}
	        				else
	        				{
	        					$('#check').text("今天无新消息")
	        				}
	        				setTimeout(function(){
	        					$('#check').text("更新")
	        				},500)
	        			}
	        		})
	        	})
	        </script>
{% endblock body %}